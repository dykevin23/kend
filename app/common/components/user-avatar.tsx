import { cn } from "~/lib/utils";
import { Avatar, AvatarFallback, AvatarImage } from "./ui/avatar";
import { Camera } from "lucide-react";
import { useRef, useState } from "react";
import { Button } from "./ui/button";

export default function UserAvatar({
  name,
  avatar,
  className,
  mode = "view",
  onClick,
}: {
  name: string;
  avatar: string | null;
  className?: string;
  mode: "view" | "modify";
  onClick?: () => void;
}) {
  // console.log("### avatar => ", avatar);
  return (
    <Avatar
      className={cn(
        "shrink-0 aspect-square rounded-full border-1 bg-muted-foreground relative overflow-auto",
        className
      )}
      onClick={() => {
        if (mode === "modify") onClick?.();
      }}
    >
      <AvatarFallback className="text-5xl">
        {name.charAt(0).toUpperCase()}
      </AvatarFallback>
      {avatar ? <AvatarImage src={avatar} /> : null}

      {mode === "modify" && (
        <div className="absolute bottom-1 right-1 size-7 bg-white rounded-full flex justify-center items-center shrink-0 aspect-square border-1 border-muted">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="20"
            height="20"
            viewBox="0 0 20 20"
            fill="none"
          >
            <path
              d="M10.0002 13.5404C11.2444 13.5404 12.2531 12.5318 12.2531 11.2875C12.2531 10.0433 11.2444 9.03467 10.0002 9.03467C8.75596 9.03467 7.74731 10.0433 7.74731 11.2875C7.74731 12.5318 8.75596 13.5404 10.0002 13.5404Z"
              fill="#949494"
            />
            <path
              d="M16.7587 5.81629H14.6481C14.5129 5.81632 14.3812 5.77381 14.2716 5.69479C14.1619 5.61577 14.0799 5.50424 14.0372 5.37601L13.8338 4.76516C13.7483 4.50883 13.5843 4.28592 13.365 4.12799C13.1457 3.97007 12.8823 3.88514 12.6121 3.88525H7.38739C7.1172 3.88532 6.85388 3.9704 6.63473 4.12844C6.41558 4.28648 6.25171 4.50946 6.16633 4.76581L5.96293 5.37601C5.92022 5.50424 5.83824 5.61577 5.7286 5.69479C5.61896 5.77381 5.48723 5.81632 5.35208 5.81629H3.24146C2.90003 5.81629 2.57259 5.95192 2.33116 6.19335C2.08973 6.43477 1.9541 6.76222 1.9541 7.10364V14.8278C1.9541 15.1692 2.08973 15.4967 2.33116 15.7381C2.57259 15.9795 2.90003 16.1151 3.24146 16.1151H16.7587C17.1001 16.1151 17.4276 15.9795 17.669 15.7381C17.9104 15.4967 18.0461 15.1692 18.0461 14.8278V7.10364C18.0461 6.76222 17.9104 6.43477 17.669 6.19335C17.4276 5.95192 17.1001 5.81629 16.7587 5.81629ZM10.0001 14.8278C8.04845 14.8278 6.45985 13.2392 6.45985 11.2876C6.45985 9.33592 8.04845 7.74732 10.0001 7.74732C11.9517 7.74732 13.5403 9.33592 13.5403 11.2876C13.5403 13.2392 11.9517 14.8278 10.0001 14.8278ZM13.8621 8.391C13.6914 8.391 13.5277 8.32318 13.407 8.20247C13.2863 8.08176 13.2185 7.91804 13.2185 7.74732C13.2185 7.57661 13.2863 7.41289 13.407 7.29217C13.5277 7.17146 13.6914 7.10364 13.8621 7.10364C14.0329 7.10364 14.1966 7.17146 14.3173 7.29217C14.438 7.41289 14.5058 7.57661 14.5058 7.74732C14.5058 7.91804 14.438 8.08176 14.3173 8.20247C14.1966 8.32318 14.0329 8.391 13.8621 8.391Z"
              fill="#949494"
            />
            <path
              d="M4.2071 5.17249H2.91974C2.83438 5.17249 2.75252 5.13858 2.69216 5.07822C2.63181 5.01787 2.5979 4.936 2.5979 4.85065C2.5979 4.76529 2.63181 4.68343 2.69216 4.62307C2.75252 4.56272 2.83438 4.52881 2.91974 4.52881H4.2071C4.29245 4.52881 4.37431 4.56272 4.43467 4.62307C4.49503 4.68343 4.52893 4.76529 4.52893 4.85065C4.52893 4.936 4.49503 5.01787 4.43467 5.07822C4.37431 5.13858 4.29245 5.17249 4.2071 5.17249Z"
              fill="#949494"
            />
          </svg>
        </div>
      )}
    </Avatar>
  );
}
